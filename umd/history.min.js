!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.History={})}(this,function(n){"use strict";function E(){return(E=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n}).apply(this,arguments)}function d(n){return"/"===n.charAt(0)}function v(n,t){for(var e=t,o=e+1,r=n.length;o<r;e+=1,o+=1)n[e]=n[o];n.pop()}function i(n){return n.valueOf?n.valueOf():Object.prototype.valueOf.call(n)}function H(n){return"/"===n.charAt(0)?n:"/"+n}function t(n){return"/"===n.charAt(0)?n.substr(1):n}function S(n,t){return o=t,0===(e=n).toLowerCase().indexOf(o.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(o.length))?n.substr(t.length):n;var e,o}function j(n){return"/"===n.charAt(n.length-1)?n.slice(0,-1):n}function a(n){var t=n||"/",e="",o="",r=t.indexOf("#");-1!==r&&(o=t.substr(r),t=t.substr(0,r));var i=t.indexOf("?");return-1!==i&&(e=t.substr(i),t=t.substr(0,i)),{pathname:t,search:"?"===e?"":e,hash:"#"===o?"":o}}function C(n){var t=n.pathname,e=n.search,o=n.hash,r=t||"/";return e&&"?"!==e&&(r+="?"===e.charAt(0)?e:"?"+e),o&&"#"!==o&&(r+="#"===o.charAt(0)?o:"#"+o),r}function U(n,t,e,o){var r;return"string"==typeof n?(r=a(n)).state=t:(void 0===(r=E({},n)).pathname&&(r.pathname=""),r.search?"?"!==r.search.charAt(0)&&(r.search="?"+r.search):r.search="",r.hash?"#"!==r.hash.charAt(0)&&(r.hash="#"+r.hash):r.hash="",void 0!==t&&void 0===r.state&&(r.state=t)),e&&(r.key=e),o?r.pathname?"/"!==r.pathname.charAt(0)&&(r.pathname=function(n,t){void 0===t&&(t="");var e,o,r=n&&n.split("/")||[],i=t&&t.split("/")||[],a=n&&d(n),c=t&&d(t),u=a||c;if(n&&d(n)?i=r:r.length&&(i.pop(),i=i.concat(r)),!i.length)return"/";o=!!i.length&&("."===(e=i[i.length-1])||".."===e||""===e);for(var f=0,s=i.length;0<=s;s--){var h=i[s];"."===h?v(i,s):".."===h?(v(i,s),f++):f&&(v(i,s),f--)}if(!u)for(;f--;)i.unshift("..");!u||""===i[0]||i[0]&&d(i[0])||i.unshift("");var l=i.join("/");return o&&"/"!==l.substr(-1)&&(l+="/"),l}(r.pathname,o.pathname)):r.pathname=o.pathname:r.pathname||(r.pathname="/"),r}function M(){var i=null;var o=[];return{setPrompt:function(n){return i=n,function(){i===n&&(i=null)}},confirmTransitionTo:function(n,t,e,o){var r;null!=i?"string"==typeof(r="function"==typeof i?i(n,t):i)?"function"==typeof e?e(r,o):o(!0):o(!1!==r):o(!0)},appendListener:function(n){var t=!0;function e(){t&&n.apply(void 0,arguments)}return o.push(e),function(){t=!1,o=o.filter(function(n){return n!==e})}},notifyListeners:function(){for(var n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];o.forEach(function(n){return n.apply(void 0,t)})}}}var I=!("undefined"==typeof window||!window.document||!window.document.createElement);function B(n,t){t(window.confirm(n))}var e="Invariant failed";function F(n){if(!n)throw new Error(e)}var R="popstate",q="hashchange";function _(){try{return window.history.state||{}}catch(n){return{}}}var k="hashchange",L={hashbang:{encodePath:function(n){return"!"===n.charAt(0)?n:"!/"+t(n)},decodePath:function(n){return"!"===n.charAt(0)?n.substr(1):n}},noslash:{encodePath:t,decodePath:H},slash:{encodePath:H,decodePath:H}};function T(n){var t=n.indexOf("#");return-1===t?n:n.slice(0,t)}function G(){var n=window.location.href,t=n.indexOf("#");return-1===t?"":n.substring(t+1)}function W(n){window.location.replace(T(window.location.href)+"#"+n)}function p(n,t,e){return Math.min(Math.max(n,t),e)}n.createBrowserHistory=function(n){void 0===n&&(n={}),I||F(!1);var t,c=window.history,u=(-1===(t=window.navigator.userAgent).indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history),e=!(-1===window.navigator.userAgent.indexOf("Trident")),o=n.forceRefresh,f=void 0!==o&&o,r=n.getUserConfirmation,s=void 0===r?B:r,i=n.keyLength,a=void 0===i?6:i,h=n.basename?j(H(n.basename)):"";function l(n){var t=n||{},e=t.key,o=t.state,r=window.location,i=r.pathname+r.search+r.hash;return h&&(i=S(i,h)),U(i,o,e)}function d(){return Math.random().toString(36).substr(2,a)}var v=M();function p(n){E(T,n),T.length=c.length,v.notifyListeners(T.location,T.action)}function w(n){void 0===n.state&&-1===navigator.userAgent.indexOf("CriOS")||m(l(n.state))}function g(){m(l(_()))}var y=!1;function m(t){y?(y=!1,p()):v.confirmTransitionTo(t,"POP",s,function(n){n?p({action:"POP",location:t}):function(n){var t=T.location,e=O.indexOf(t.key);-1===e&&(e=0);var o=O.indexOf(n.key);-1===o&&(o=0);var r=e-o;r&&(y=!0,b(r))}(t)})}var P=l(_()),O=[P.key];function x(n){return h+C(n)}function b(n){c.go(n)}var A=0;function k(n){1===(A+=n)&&1===n?(window.addEventListener(R,w),e&&window.addEventListener(q,g)):0===A&&(window.removeEventListener(R,w),e&&window.removeEventListener(q,g))}var L=!1,T={length:c.length,action:"POP",location:P,createHref:x,push:function(n,t){var a=U(n,t,d(),T.location);v.confirmTransitionTo(a,"PUSH",s,function(n){var t,e,o,r,i;n&&(t=x(a),e=a.key,o=a.state,u?(c.pushState({key:e,state:o},null,t),f?window.location.href=t:(r=O.indexOf(T.location.key),(i=O.slice(0,r+1)).push(a.key),O=i,p({action:"PUSH",location:a}))):window.location.href=t)})},replace:function(n,t){var i="REPLACE",a=U(n,t,d(),T.location);v.confirmTransitionTo(a,i,s,function(n){var t,e,o,r;n&&(t=x(a),e=a.key,o=a.state,u?(c.replaceState({key:e,state:o},null,t),f?window.location.replace(t):(-1!==(r=O.indexOf(T.location.key))&&(O[r]=a.key),p({action:i,location:a}))):window.location.replace(t))})},go:b,goBack:function(){b(-1)},goForward:function(){b(1)},block:function(n){void 0===n&&(n=!1);var t=v.setPrompt(n);return L||(k(1),L=!0),function(){return L&&(L=!1,k(-1)),t()}},listen:function(n){var t=v.appendListener(n);return k(1),function(){k(-1),t()}}};return T},n.createHashHistory=function(n){void 0===n&&(n={}),I||F(!1);var t=window.history,e=(window.navigator.userAgent.indexOf("Firefox"),n.getUserConfirmation),c=void 0===e?B:e,o=n.hashType,r=void 0===o?"slash":o,u=n.basename?j(H(n.basename)):"",i=L[r],f=i.encodePath,a=i.decodePath;function s(){var n=a(G());return u&&(n=S(n,u)),U(n)}var h=M();function l(n){E(A,n),A.length=t.length,h.notifyListeners(A.location,A.action)}var d=!1,v=null;function p(){var n,t,e=G(),o=f(e);if(e!==o)W(o);else{var r=s(),i=A.location;if(!d&&(t=r,(n=i).pathname===t.pathname&&n.search===t.search&&n.hash===t.hash))return;if(v===C(r))return;v=null,function(t){{d?(d=!1,l()):h.confirmTransitionTo(t,"POP",c,function(n){n?l({action:"POP",location:t}):function(n){var t=A.location,e=m.lastIndexOf(C(t));-1===e&&(e=0);var o=m.lastIndexOf(C(n));-1===o&&(o=0);var r=e-o;r&&(d=!0,P(r))}(t)})}}(r)}}var w=G(),g=f(w);w!==g&&W(g);var y=s(),m=[C(y)];function P(n){t.go(n)}var O=0;function x(n){1===(O+=n)&&1===n?window.addEventListener(k,p):0===O&&window.removeEventListener(k,p)}var b=!1,A={length:t.length,action:"POP",location:y,createHref:function(n){var t=document.querySelector("base"),e="";return t&&t.getAttribute("href")&&(e=T(window.location.href)),e+"#"+f(u+C(n))},push:function(n,t){var a=U(n,void 0,void 0,A.location);h.confirmTransitionTo(a,"PUSH",c,function(n){var t,e,o,r,i;n&&(t=C(a),e=f(u+t),G()!==e?(v=t,i=e,window.location.hash=i,o=m.lastIndexOf(C(A.location)),(r=m.slice(0,o+1)).push(t),m=r,l({action:"PUSH",location:a})):l())})},replace:function(n,t){var r="REPLACE",i=U(n,void 0,void 0,A.location);h.confirmTransitionTo(i,r,c,function(n){var t,e,o;n&&(t=C(i),e=f(u+t),G()!==e&&(v=t,W(e)),-1!==(o=m.indexOf(C(A.location)))&&(m[o]=t),l({action:r,location:i}))})},go:P,goBack:function(){P(-1)},goForward:function(){P(1)},block:function(n){void 0===n&&(n=!1);var t=h.setPrompt(n);return b||(x(1),b=!0),function(){return b&&(b=!1,x(-1)),t()}},listen:function(n){var t=h.appendListener(n);return x(1),function(){x(-1),t()}}};return A},n.createMemoryHistory=function(n){void 0===n&&(n={});var r=n.getUserConfirmation,t=n.initialEntries,e=void 0===t?["/"]:t,o=n.initialIndex,i=void 0===o?0:o,a=n.keyLength,c=void 0===a?6:a,u=M();function f(n){E(v,n),v.length=v.entries.length,u.notifyListeners(v.location,v.action)}function s(){return Math.random().toString(36).substr(2,c)}var h=p(i,0,e.length-1),l=e.map(function(n){return U(n,void 0,"string"!=typeof n&&n.key||s())});function d(n){var t=p(v.index+n,0,v.entries.length-1),e=v.entries[t];u.confirmTransitionTo(e,"POP",r,function(n){n?f({action:"POP",location:e,index:t}):f()})}var v={length:l.length,action:"POP",location:l[h],index:h,entries:l,createHref:C,push:function(n,t){var o=U(n,t,s(),v.location);u.confirmTransitionTo(o,"PUSH",r,function(n){var t,e;n&&(t=v.index+1,(e=v.entries.slice(0)).length>t?e.splice(t,e.length-t,o):e.push(o),f({action:"PUSH",location:o,index:t,entries:e}))})},replace:function(n,t){var e="REPLACE",o=U(n,t,s(),v.location);u.confirmTransitionTo(o,e,r,function(n){n&&(v.entries[v.index]=o,f({action:e,location:o}))})},go:d,goBack:function(){d(-1)},goForward:function(){d(1)},canGo:function(n){var t=v.index+n;return 0<=t&&t<v.entries.length},block:function(n){return void 0===n&&(n=!1),u.setPrompt(n)},listen:function(n){return u.appendListener(n)}};return v},n.createLocation=U,n.locationsAreEqual=function(n,t){return n.pathname===t.pathname&&n.search===t.search&&n.hash===t.hash&&n.key===t.key&&function e(t,o){if(t===o)return!0;if(null==t||null==o)return!1;if(Array.isArray(t))return Array.isArray(o)&&t.length===o.length&&t.every(function(n,t){return e(n,o[t])});if("object"!=typeof t&&"object"!=typeof o)return!1;var n=i(t),r=i(o);return n!==t||r!==o?e(n,r):Object.keys(Object.assign({},t,o)).every(function(n){return e(t[n],o[n])})}(n.state,t.state)},n.parsePath=a,n.createPath=C,Object.defineProperty(n,"__esModule",{value:!0})});
